
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://accidda.github.io/flepimop2/0.1/development/adding-a-new-cli-command/">
      
      
        <link rel="prev" href="../creating-an-external-provider-package/">
      
      
        <link rel="next" href="../../reference/api/abcs/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Adding A New CLI Command - flepimop2 Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adding-a-new-cli-command" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest version.
  <a href="../../..">
    <strong>Click here to go to latest.</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="flepimop2 Documentation" class="md-header__button md-logo" aria-label="flepimop2 Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            flepimop2 Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Adding A New CLI Command
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ACCIDDA/flepimop2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ACCIDDA/flepimop2
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="flepimop2 Documentation" class="md-nav__button md-logo" aria-label="flepimop2 Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    flepimop2 Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ACCIDDA/flepimop2" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    ACCIDDA/flepimop2
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Guides
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Guides
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Development
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Development
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../creating-an-external-provider-package/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Creating An External Provider Package
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Adding A New CLI Command
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding A New CLI Command
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#brief-overview-of-flepimop2s-cli-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Brief Overview Of flepimop2's CLI Infrastructure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-the-flepimop2-hello-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding The flepimop2 hello Command
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding The flepimop2 hello Command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-the-hellocommand-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        Add The HelloCommand Class
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-option" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding A New Option
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-the-new-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        Register The New Command
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-a-new-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing A New Command
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing A New Command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ad-hoc-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ad-Hoc Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unit-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unit Testing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/abcs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Abcs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/backend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Backend
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/engine/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Engine
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/exceptions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/meta/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Meta
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/parameter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parameter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/process/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Process
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/system/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    System
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#brief-overview-of-flepimop2s-cli-infrastructure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Brief Overview Of flepimop2's CLI Infrastructure
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-the-flepimop2-hello-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding The flepimop2 hello Command
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding The flepimop2 hello Command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-the-hellocommand-class" class="md-nav__link">
    <span class="md-ellipsis">
      
        Add The HelloCommand Class
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-option" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding A New Option
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register-the-new-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        Register The New Command
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-a-new-command" class="md-nav__link">
    <span class="md-ellipsis">
      
        Testing A New Command
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing A New Command">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ad-hoc-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ad-Hoc Testing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unit-testing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Unit Testing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<!-- skip: start -->
<h1 id="adding-a-new-cli-command">Adding A New CLI Command<a class="headerlink" href="#adding-a-new-cli-command" title="Permanent link">&para;</a></h1>
<p>This tutorial will show how to:</p>
<ul>
<li>Add a new command to the <code>flepimop2</code> CLI.</li>
<li>Add a new option to <code>flepimop2</code>'s CLI infrastructure.</li>
<li>Test the newly added command.</li>
</ul>
<p>In this tutorial will demonstrate adding a new command called <code>flepimop2 hello</code> which will print hello world a user specified number of times.</p>
<h2 id="brief-overview-of-flepimop2s-cli-infrastructure">Brief Overview Of <code>flepimop2</code>'s CLI Infrastructure<a class="headerlink" href="#brief-overview-of-flepimop2s-cli-infrastructure" title="Permanent link">&para;</a></h2>
<p><code>flepimop2</code>'s CLI infrastructure might be a bit heavier and stricter than previous CLI programs a developer has worked with. The reason for this is to enforce consistency for the inputs and outputs of CLI commands. The primary restrictions of this approach are:</p>
<ul>
<li>CLI commands must implement a common abstract base class which provides a common framework for command implementations.</li>
<li>Options/arguments are shared among all CLI commands so they have the same meaning and usage across commands. Developers cannot add bespoke options/arguments for their command.</li>
<li>CLI outputs are made consistent via a common logging infrastructure so the outputs of commands have a common feel across the <code>flepimop2</code> CLI.</li>
</ul>
<p><code>flepimop2</code>'s CLI infrastructure is contained in the private <code>flepimop2._cli</code> subpackage. The most important elements of this subpackage are:</p>
<ul>
<li><code>CliCommand</code>: The abstract base class that CLI commands must implement. The main benefit of having CLI commands subclass a common class is that repeated logic can be consolidated, CLI inputs/outputs can be made consistent, and development work can be eased.</li>
<li><code>COMMON_OPTIONS</code>: A constant dictionary mapping option/argument names to their definitions. CLI commands can request options/arguments from this dictionary by having them as keyword only arguments to their <code>run</code> method. The main benefit of this approach is that commands cannot define bespoke options/arguments and developers are forced to use consistent meanings across commands. I.e. the <code>--dry-run</code> option means the same thing in all commands.</li>
<li><code>register_command</code>: The function that attaches a user's implementation of <code>CliCommand</code> to the <code>flepimop2</code> CLI.</li>
</ul>
<p>This infrastructure utilizes <a href="https://click.palletsprojects.com/en/stable/"><code>click</code></a> so it may be helpful to reference their documentation occasionally. </p>
<h2 id="adding-the-flepimop2-hello-command">Adding The <code>flepimop2 hello</code> Command<a class="headerlink" href="#adding-the-flepimop2-hello-command" title="Permanent link">&para;</a></h2>
<p>In particular this tutorial will be add a new command to the <code>flepimop2</code> CLI called <code>hello</code> which will take a new number argument. The end result of this tutorial will be:</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>flepimop2<span class="w"> </span>--help
Usage:<span class="w"> </span>flepimop2<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span>COMMAND<span class="w"> </span><span class="o">[</span>ARGS<span class="o">]</span>...

<span class="w">  </span>flepimop2<span class="w"> </span>-<span class="w"> </span>Flexible<span class="w"> </span>Epidemic<span class="w"> </span>Modeling<span class="w"> </span>Pipeline<span class="w"> </span><span class="o">(</span>version<span class="w"> </span><span class="m">2</span><span class="o">)</span>.

Options:
<span class="w">  </span>--version<span class="w">  </span>Show<span class="w"> </span>the<span class="w"> </span>version<span class="w"> </span>and<span class="w"> </span>exit.
<span class="w">  </span>--help<span class="w">     </span>Show<span class="w"> </span>this<span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span>exit.

Commands:
<span class="w">  </span>build<span class="w">     </span>Compile<span class="w"> </span>and<span class="w"> </span>build<span class="w"> </span>a<span class="w"> </span>model<span class="w"> </span>defined<span class="w"> </span><span class="k">in</span><span class="w"> </span>a<span class="w"> </span>configuration<span class="w"> </span>file.
<span class="w">  </span>hello<span class="w">     </span>This<span class="w"> </span><span class="nb">command</span><span class="w"> </span>says<span class="w"> </span>hello<span class="w"> </span>a<span class="w"> </span>specified<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>times.
<span class="w">  </span>process<span class="w">   </span>Execute<span class="w"> </span>a<span class="w"> </span>processing<span class="w"> </span>step<span class="w"> </span>based<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>configuration<span class="w"> </span>file.
<span class="w">  </span>simulate<span class="w">  </span>Run<span class="w"> </span>simulations<span class="w"> </span>based<span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>configuration<span class="w"> </span>file.
$<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span>--help
Usage:<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span><span class="o">[</span>TIMES<span class="o">]</span>

<span class="w">  </span>This<span class="w"> </span><span class="nb">command</span><span class="w"> </span>says<span class="w"> </span>hello<span class="w"> </span>a<span class="w"> </span>specified<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>times.

Options:
<span class="w">  </span>--dry-run<span class="w">        </span>Should<span class="w"> </span>this<span class="w"> </span><span class="nb">command</span><span class="w"> </span>be<span class="w"> </span>run<span class="w"> </span>using<span class="w"> </span>dry<span class="w"> </span>run?
<span class="w">  </span>-v,<span class="w"> </span>--verbosity<span class="w">  </span>The<span class="w"> </span>verbosity<span class="w"> </span>level<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>command.
<span class="w">  </span>--help<span class="w">           </span>Show<span class="w"> </span>this<span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span>exit.
</code></pre></div>
<h3 id="add-the-hellocommand-class">Add The <code>HelloCommand</code> Class<a class="headerlink" href="#add-the-hellocommand-class" title="Permanent link">&para;</a></h3>
<p>The first step is to implement the <code>HelloCommand</code> class in a new <code>src/flepimop2/_cli/_hello_command.py</code> file.</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Hello command implementation.&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[]</span>


<span class="kn">from</span><span class="w"> </span><span class="nn">flepimop2._cli._cli_command</span><span class="w"> </span><span class="kn">import</span> <span class="n">CliCommand</span>


<span class="k">class</span><span class="w"> </span><span class="nc">HelloCommand</span><span class="p">(</span><span class="n">CliCommand</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This command says hello a specified number of times.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">times</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dry_run</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># type: ignore[override]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Say hello a specified number of times.</span>

<span class="sd">        Args:</span>
<span class="sd">            times: The number of times to say hello.</span>
<span class="sd">            dry_run: Whether dry run mode is enabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">dry_run</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Would said hello </span><span class="si">{</span><span class="n">times</span><span class="si">}</span><span class="s2"> time(s).&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">times</span><span class="si">}</span><span class="s2">) Hello, world!&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The <code>run</code> method contains the logic of the command and it's keyword arguments correspond to the options/arguments requested from <code>COMMON_OPTIONS</code>. The <code>CliCommand</code> also provides consistent logging infrastructure in the form of the <code>log</code>, <code>debug</code>, <code>info</code>, <code>warning</code>, <code>error</code>, and <code>critical</code> methods. Note that a <code>verbosity</code> option is not explicitly requested, this option is added by default to the command and <code>CliCommand</code> handles translating the given verbosity to a logging level so developers only need to concern themselves with calling the appropriate logging method. To ease development the class docstring will be used as the help string for the command and the command's name is extracted from the class name.</p>
<h3 id="adding-a-new-option">Adding A New Option<a class="headerlink" href="#adding-a-new-option" title="Permanent link">&para;</a></h3>
<p>The implementation of <code>flepimop2 hello</code> needs a times argument. To add this argument a developer needs to add it to the <code>COMMON_OPTIONS</code> dictionary in <code>src/flepimop2/_cli/_options.py</code>.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Dictionary of common Click options and arguments</span>
<span class="c1"># These can be requested by command classes to maintain consistency</span>
<span class="n">COMMON_OPTIONS</span><span class="p">:</span> <span class="n">Final</span> <span class="o">=</span> <span class="p">{</span>
    <span class="o">...</span>
    <span class="s2">&quot;times&quot;</span><span class="p">:</span> <span class="n">click</span><span class="o">.</span><span class="n">argument</span><span class="p">(</span>
        <span class="s2">&quot;times&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="n">click</span><span class="o">.</span><span class="n">IntRange</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre></div>
<p>This adds a new <code>times</code> argument to the <code>COMMON_OPTIONS</code> dictionary. Note that the argument is not tied specifically to the <code>flepimop2 hello</code> command since this argument could be used by other commands.</p>
<h3 id="register-the-new-command">Register The New Command<a class="headerlink" href="#register-the-new-command" title="Permanent link">&para;</a></h3>
<p>The final step is to register the new command with the <code>flepimop2</code> CLI by adding a call to <code>register_command</code> in <code>src/flepimop2/_cli/_cli.py</code>.</p>
<div class="highlight"><pre><span></span><code><span class="o">...</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flepimop2._cli._build_command</span><span class="w"> </span><span class="kn">import</span> <span class="n">BuildCommand</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flepimop2._cli._hello_command</span><span class="w"> </span><span class="kn">import</span> <span class="n">HelloCommand</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flepimop2._cli._process_command</span><span class="w"> </span><span class="kn">import</span> <span class="n">ProcessCommand</span>
<span class="o">...</span>
<span class="c1"># Register all commands</span>
<span class="n">register_command</span><span class="p">(</span><span class="n">BuildCommand</span><span class="p">,</span> <span class="n">cli</span><span class="p">)</span>
<span class="n">register_command</span><span class="p">(</span><span class="n">SimulateCommand</span><span class="p">,</span> <span class="n">cli</span><span class="p">)</span>
<span class="n">register_command</span><span class="p">(</span><span class="n">ProcessCommand</span><span class="p">,</span> <span class="n">cli</span><span class="p">)</span>
<span class="n">register_command</span><span class="p">(</span><span class="n">HelloCommand</span><span class="p">,</span> <span class="n">cli</span><span class="p">)</span>
</code></pre></div>
<p>The <code>register_command</code> function takes the CLI command class as it's first argument and the <a href="https://click.palletsprojects.com/en/stable/api/#click.Group"><code>click.Group</code></a> to attach the command to. In this case the command is being attached to the main cli, <code>cli</code>, so it can be invoked <code>flepimop2 hello</code>. But one could have created a new click group so one could have nested subcommands, i.e. <code>flepimop2 greetings hello</code>.</p>
<h2 id="testing-a-new-command">Testing A New Command<a class="headerlink" href="#testing-a-new-command" title="Permanent link">&para;</a></h2>
<p>Before preparing this command for a PR it's important to test the new command. There are two types of testing:</p>
<ol>
<li>Ad-hoc testing: Testing the command manually for expected behavior.</li>
<li>Unit testing: Programmatically testing the command.</li>
</ol>
<h3 id="ad-hoc-testing">Ad-Hoc Testing<a class="headerlink" href="#ad-hoc-testing" title="Permanent link">&para;</a></h3>
<p>The first pass for testing a new command should be ad-hoc testing because it's the easiest way to get feedback during development. This entails running the command several times and manually checking that the output matches the expected.</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span>--help
Usage:<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span><span class="o">[</span>TIMES<span class="o">]</span>

<span class="w">  </span>This<span class="w"> </span><span class="nb">command</span><span class="w"> </span>says<span class="w"> </span>hello<span class="w"> </span>a<span class="w"> </span>specified<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>times.

Options:
<span class="w">  </span>--dry-run<span class="w">        </span>Should<span class="w"> </span>this<span class="w"> </span><span class="nb">command</span><span class="w"> </span>be<span class="w"> </span>run<span class="w"> </span>using<span class="w"> </span>dry<span class="w"> </span>run?
<span class="w">  </span>-v,<span class="w"> </span>--verbosity<span class="w">  </span>The<span class="w"> </span>verbosity<span class="w"> </span>level<span class="w"> </span>to<span class="w"> </span>use<span class="w"> </span><span class="k">for</span><span class="w"> </span>this<span class="w"> </span>command.
<span class="w">  </span>--help<span class="w">           </span>Show<span class="w"> </span>this<span class="w"> </span>message<span class="w"> </span>and<span class="w"> </span>exit.
$<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span><span class="m">3</span>
$<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span>-v<span class="w"> </span><span class="m">3</span>
$<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span>-vv<span class="w"> </span><span class="m">3</span>
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:48:40,962:INFO&gt;<span class="w"> </span><span class="o">(</span><span class="m">1</span>/3<span class="o">)</span><span class="w"> </span>Hello,<span class="w"> </span>world!
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:48:40,962:INFO&gt;<span class="w"> </span><span class="o">(</span><span class="m">2</span>/3<span class="o">)</span><span class="w"> </span>Hello,<span class="w"> </span>world!
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:48:40,962:INFO&gt;<span class="w"> </span><span class="o">(</span><span class="m">3</span>/3<span class="o">)</span><span class="w"> </span>Hello,<span class="w"> </span>world!
$<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span>-vvv<span class="w"> </span><span class="m">3</span>
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:48:46,452:DEBUG&gt;<span class="w"> </span>Given<span class="w"> </span><span class="m">2</span><span class="w"> </span>options/arguments:
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:48:46,452:DEBUG&gt;<span class="w"> </span><span class="nb">times</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>.
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:48:46,452:DEBUG&gt;<span class="w"> </span><span class="nv">dry_run</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:48:46,452:INFO&gt;<span class="w"> </span><span class="o">(</span><span class="m">1</span>/3<span class="o">)</span><span class="w"> </span>Hello,<span class="w"> </span>world!
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:48:46,452:INFO&gt;<span class="w"> </span><span class="o">(</span><span class="m">2</span>/3<span class="o">)</span><span class="w"> </span>Hello,<span class="w"> </span>world!
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:48:46,452:INFO&gt;<span class="w"> </span><span class="o">(</span><span class="m">3</span>/3<span class="o">)</span><span class="w"> </span>Hello,<span class="w"> </span>world!
$<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span>-vv<span class="w"> </span>--dry-run<span class="w"> </span><span class="m">5</span>
<span class="m">2025</span>-11-06<span class="w"> </span><span class="m">09</span>:49:00,106:INFO&gt;<span class="w"> </span>Would<span class="w"> </span>said<span class="w"> </span>hello<span class="w"> </span><span class="m">5</span><span class="w"> </span>time<span class="o">(</span>s<span class="o">)</span>.
$<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span><span class="m">0</span>
Usage:<span class="w"> </span>flepimop2<span class="w"> </span>hello<span class="w"> </span><span class="o">[</span>OPTIONS<span class="o">]</span><span class="w"> </span><span class="o">[</span>TIMES<span class="o">]</span>
Try<span class="w"> </span><span class="s1">&#39;flepimop2 hello --help&#39;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>help.

Error:<span class="w"> </span>Invalid<span class="w"> </span>value<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">&#39;[TIMES]&#39;</span>:<span class="w"> </span><span class="m">0</span><span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>range<span class="w"> </span>x&gt;<span class="o">=</span><span class="m">1</span>.
</code></pre></div>
<p>This quick ad-hoc testing matches the following expected behavior:</p>
<ul>
<li>The command should only produce output at <code>-vv</code> and above because it uses the <code>info</code> method to log output.</li>
<li>The command says "Hello, world!" the number of times given.</li>
<li>Providing <code>--dry-run</code> does not repeat the greeting, but instead says it would have done so.</li>
<li>Providing 0 or less for times results in an error that is caught before the command can run.</li>
</ul>
<h3 id="unit-testing">Unit Testing<a class="headerlink" href="#unit-testing" title="Permanent link">&para;</a></h3>
<p>Ad-hoc testing is great for development purposes or diagnosing bugs quickly, but is not sustainable for long term maintenance. However, writing unit tests for CLI commands can be especially tricky because much of what CLI commands do is glue together behavior from other objects and emit output. Before unit testing a CLI command a developer should ask the following:</p>
<ol>
<li>Can this behavior and corresponding unit test be pushed down to the object being operated on or a new function? For example, suppose that <code>flepimop2 hello</code> worked with the <code>RunMeta</code> object and formatted the timestamp for display. In this case the formatting behavior should be added to the <code>RunMeta</code> object and tested there instead of testing that behavior via <code>HelloCommand</code>.</li>
<li>Is the behavior essential to the CLI command? For example, the output logged to the user is non-essential. <code>flepimop2</code> does not make guarantees about CLI output consistency across versions. The only case where one might want to test the logged output is to see if a particular branch was reached, i.e. a certain message is only emitted if certain conditions are met.</li>
</ol>
<p>With that being said, the <code>flepimop2 hello</code> command does not have behavior that would be worth unit testing. For the purposes of unit testing change the <code>HelloCommand.run</code> method to:</p>
<div class="highlight"><pre><span></span><code><span class="o">...</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">times</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">dry_run</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># type: ignore[override]</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Say hello a specified number of times.</span>

<span class="sd">        Args:</span>
<span class="sd">            times: The number of times to say hello.</span>
<span class="sd">            dry_run: Whether dry run mode is enabled.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `times` is greater than 10.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">times</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Cannot say hello more than 10 times.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dry_run</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Would said hello </span><span class="si">{</span><span class="n">times</span><span class="si">}</span><span class="s2"> time(s).&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">times</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">times</span><span class="si">}</span><span class="s2">) Hello, world!&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Now the command has behavior, raising an exception, that is worth testing and cannot be pushed to the object being operated on or an external function. To unit test this behavior add the following to <code>tests/_cli/test_hello_command.py</code>:</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Unit tests for the `flepimop2 hello` CLI command.&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">flepimop2._cli._hello_command</span><span class="w"> </span><span class="kn">import</span> <span class="n">HelloCommand</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_raises_value_error_if_times_exceeds_limit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that ValueError is raised if times &gt; 10.&quot;&quot;&quot;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">HelloCommand</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Cannot say hello more than 10 times.&quot;</span><span class="p">):</span>
        <span class="n">command</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
<p>Another benefit to <code>flepimop2</code>'s CLI infrastructure is that the <code>run</code> method of a <code>CliCommand</code> subclass can be tested directly rather than needing to use <a href="https://docs.python.org/3/library/subprocess.html#subprocess.run"><code>subprocess.run</code></a> or <a href="https://click.palletsprojects.com/en/stable/testing/"><code>click.testing.CliRunner</code></a>. If the verbosity level needs to be controlled for a unit test a developer could modify this test by invoking <code>HelloCommand.__call__</code> instead with the same arguments as <code>run</code> but including verbosity like so:</p>
<div class="highlight"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Unit tests for the `flepimop2 hello` CLI command.&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">flepimop2._cli._hello_command</span><span class="w"> </span><span class="kn">import</span> <span class="n">HelloCommand</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pytest</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_raises_value_error_if_times_exceeds_limit</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Test that ValueError is raised if times &gt; 10.&quot;&quot;&quot;</span>
    <span class="n">command</span> <span class="o">=</span> <span class="n">HelloCommand</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;Cannot say hello more than 10 times.&quot;</span><span class="p">):</span>
        <span class="n">command</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">dry_run</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>This tutorial covered:</p>
<ul>
<li>A high level overview of the <code>flepimop2</code> CLI infrastructure.</li>
<li>Adding a new command to the <code>flepimop2</code> CLI.</li>
<li>Adding a new option to <code>flepimop2</code>'s CLI infrastructure.</li>
<li>Testing the newly added command.</li>
</ul>
<!-- skip: end -->












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>